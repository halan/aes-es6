<!DOCTYPE html><html lang="en"><head><title>steps/mixColumns</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="steps/mixColumns"><meta name="groc-project-path" content="src/steps/mixColumns.js"><meta name="groc-github-url" content="https://github.com/halan/aes-es6"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/halan/aes-es6/blob/master/src/steps/mixColumns.js">src/steps/mixColumns.js</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/76/AES-MixColumns.svg/320px-AES-MixColumns.svg.png" alt=""></p>
<p>Na etapa de MixColumns, os quatro bytes de cada coluna do estado
são combinados usando uma transformação linear invertível.
(<a href="https://pt.wikipedia.org/wiki/Advanced_Encryption_Standard#Etapa_de_MixColumns">fonte</a>)</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> G2 =
  [<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x1a</span>,<span class="hljs-number">0x1c</span>,<span class="hljs-number">0x1e</span>,
   <span class="hljs-number">0x20</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x30</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x3a</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x3e</span>,
   <span class="hljs-number">0x40</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x4e</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x5a</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0x5e</span>,
   <span class="hljs-number">0x60</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0x6c</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x7e</span>,
   <span class="hljs-number">0x80</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x8a</span>,<span class="hljs-number">0x8c</span>,<span class="hljs-number">0x8e</span>,<span class="hljs-number">0x90</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x9e</span>,
   <span class="hljs-number">0xa0</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xa6</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0xaa</span>,<span class="hljs-number">0xac</span>,<span class="hljs-number">0xae</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0xb2</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0xbe</span>,
   <span class="hljs-number">0xc0</span>,<span class="hljs-number">0xc2</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xc6</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xca</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0xd0</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0xd4</span>,<span class="hljs-number">0xd6</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0xda</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xde</span>,
   <span class="hljs-number">0xe0</span>,<span class="hljs-number">0xe2</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xea</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xee</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xf2</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xf6</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xfa</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xfe</span>,
   <span class="hljs-number">0x1b</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x1f</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x05</span>,
   <span class="hljs-number">0x3b</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x2f</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x25</span>,
   <span class="hljs-number">0x5b</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x4f</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x45</span>,
   <span class="hljs-number">0x7b</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x6f</span>,<span class="hljs-number">0x6d</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x65</span>,
   <span class="hljs-number">0x9b</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x9f</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x8f</span>,<span class="hljs-number">0x8d</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x85</span>,
   <span class="hljs-number">0xbb</span>,<span class="hljs-number">0xb9</span>,<span class="hljs-number">0xbf</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xb3</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0xa9</span>,<span class="hljs-number">0xaf</span>,<span class="hljs-number">0xad</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0xa1</span>,<span class="hljs-number">0xa7</span>,<span class="hljs-number">0xa5</span>,
   <span class="hljs-number">0xdb</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0xdf</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0xd3</span>,<span class="hljs-number">0xd1</span>,<span class="hljs-number">0xd7</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0xcb</span>,<span class="hljs-number">0xc9</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0xc1</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0xc5</span>,
   <span class="hljs-number">0xfb</span>,<span class="hljs-number">0xf9</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0xf3</span>,<span class="hljs-number">0xf1</span>,<span class="hljs-number">0xf7</span>,<span class="hljs-number">0xf5</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0xef</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0xe3</span>,<span class="hljs-number">0xe1</span>,<span class="hljs-number">0xe7</span>,<span class="hljs-number">0xe5</span>]

<span class="hljs-keyword">const</span> G3 =
  [<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x1b</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x1d</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x11</span>,
   <span class="hljs-number">0x30</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x3f</span>,<span class="hljs-number">0x3a</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0x2e</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x21</span>,
   <span class="hljs-number">0x60</span>,<span class="hljs-number">0x63</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x6c</span>,<span class="hljs-number">0x6f</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x7b</span>,<span class="hljs-number">0x7e</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x71</span>,
   <span class="hljs-number">0x50</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x5a</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x4e</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x41</span>,
   <span class="hljs-number">0xc0</span>,<span class="hljs-number">0xc3</span>,<span class="hljs-number">0xc6</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0xca</span>,<span class="hljs-number">0xc9</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0xdb</span>,<span class="hljs-number">0xde</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0xd4</span>,<span class="hljs-number">0xd7</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0xd1</span>,
   <span class="hljs-number">0xf0</span>,<span class="hljs-number">0xf3</span>,<span class="hljs-number">0xf6</span>,<span class="hljs-number">0xf5</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xfa</span>,<span class="hljs-number">0xf9</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0xee</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xe7</span>,<span class="hljs-number">0xe2</span>,<span class="hljs-number">0xe1</span>,
   <span class="hljs-number">0xa0</span>,<span class="hljs-number">0xa3</span>,<span class="hljs-number">0xa6</span>,<span class="hljs-number">0xa5</span>,<span class="hljs-number">0xac</span>,<span class="hljs-number">0xaf</span>,<span class="hljs-number">0xaa</span>,<span class="hljs-number">0xa9</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0xbe</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xb2</span>,<span class="hljs-number">0xb1</span>,
   <span class="hljs-number">0x90</span>,<span class="hljs-number">0x93</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x9f</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x8e</span>,<span class="hljs-number">0x8d</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x82</span>,<span class="hljs-number">0x81</span>,
   <span class="hljs-number">0x9b</span>,<span class="hljs-number">0x98</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x91</span>,<span class="hljs-number">0x92</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x80</span>,<span class="hljs-number">0x85</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x8f</span>,<span class="hljs-number">0x8c</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x8a</span>,
   <span class="hljs-number">0xab</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0xad</span>,<span class="hljs-number">0xae</span>,<span class="hljs-number">0xa7</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xa1</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0xb3</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-number">0xbf</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0xb9</span>,<span class="hljs-number">0xba</span>,
   <span class="hljs-number">0xfb</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0xfe</span>,<span class="hljs-number">0xf7</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xf1</span>,<span class="hljs-number">0xf2</span>,<span class="hljs-number">0xe3</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0xe5</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0xef</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0xea</span>,
   <span class="hljs-number">0xcb</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xcd</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xc1</span>,<span class="hljs-number">0xc2</span>,<span class="hljs-number">0xd3</span>,<span class="hljs-number">0xd0</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0xd6</span>,<span class="hljs-number">0xdf</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0xda</span>,
   <span class="hljs-number">0x5b</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x57</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x4f</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x49</span>,<span class="hljs-number">0x4a</span>,
   <span class="hljs-number">0x6b</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x6d</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x62</span>,<span class="hljs-number">0x73</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x7a</span>,
   <span class="hljs-number">0x3b</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x34</span>,<span class="hljs-number">0x31</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x2f</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x2a</span>,
   <span class="hljs-number">0x0b</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x0e</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x1f</span>,<span class="hljs-number">0x1c</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x1a</span>]

<span class="hljs-keyword">const</span> mixCol = (a0, a1, a2, a3) =&gt; ([
  G2[a0] ^ G3[a1] ^     a2 ^ a3,
      a0 ^ G2[a1] ^ G3[a2] ^ a3,
      a0 ^     a1 ^ G2[a2] ^ G3[a3],
  G3[a0] ^     a1 ^     a2 ^ G2[a3]
])

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> buffer =&gt; ([
  ...mixCol(...buffer.slice(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>)),
  ...mixCol(...buffer.slice(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>)),
  ...mixCol(...buffer.slice(<span class="hljs-number">8</span>, <span class="hljs-number">12</span>)),
  ...mixCol(...buffer.slice(<span class="hljs-number">12</span>, <span class="hljs-number">16</span>)),
])</div></div></div></div></body></html>