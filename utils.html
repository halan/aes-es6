<!DOCTYPE html><html lang="en"><head><title>utils</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="utils"><meta name="groc-project-path" content="src/utils.js"><meta name="groc-github-url" content="https://github.com/halan/aes-es6"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/halan/aes-es6/blob/master/src/utils.js">src/utils.js</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> partition = size =&gt; arr =&gt;
  arr.reduce(([head = [], ...rest], x) =&gt;
    head.length &gt;= size
      ? [[x], head, ...rest]
      : [[...head, x], ...rest]
  , []).reverse()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Constante pra definir o tamanho em bytes de um word: <code>4</code>.
Esta é utilizada tanto para <code>lastWord</code> quanto para <code>splitInWords</code>.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> WORD_SIZE = <span class="hljs-number">4</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Função auxiliar que devolve a última words.
Na prática: retorna um array com os 4 últimos elementos.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> lastWord = arr =&gt; arr.length &amp;&amp; arr.slice(-WORD_SIZE)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Função auxiliar que divide um array em words, ou seja, divide em grupos de 4 elementos.</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> splitInWords = partition(WORD_SIZE)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>map, reduce, reverse e flat escritos de forma a facilitar construções utilizando pipe</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> map = fn =&gt; arr =&gt;
  arr.map(fn)

<span class="hljs-keyword">const</span> reduce = (fn, ini) =&gt; arr =&gt;
  arr.reduce(fn, ini)

<span class="hljs-keyword">const</span> reverse = arr =&gt;
  arr.reverse()

<span class="hljs-keyword">const</span> flat =
  reduce((arr, x) =&gt; [...arr, ...x], [])</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>pipe(fn1, fn2)(dado) equivale a fn2(fn1(dado))</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> pipe = (...fns) =&gt; x =&gt;
  fns.reduce((v, f) =&gt; f(v), x);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>xor byte a byte</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> xor = left =&gt; map((b, i) =&gt; left[i] ^ b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Essa função aplica uma função sobre cada valor e seu valor anterior num array
O valor de ini é aplicado sobre o primeiro valor da array
chainBlocks(x =&gt; y =&gt; x + y)(10)([1, 2, 3, 4]) -&gt; [11, 13, 16, 20]</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">const</span> chainBlocks = fn =&gt; ini =&gt;
  pipe(
    map(fn),
    reduce(([last, ...rest], partialFn) =&gt; [
      partialFn(last || ini),
      ...(last ? [last] : []),
      ...rest
    ], []),
    reverse
  )

<span class="hljs-keyword">const</span> chainBlocksInv = fn =&gt; ini =&gt;
  pipe(
    reduce(([arr, last], curr) =&gt; [
      [ ...arr, fn(last)(curr)],
      curr
    ], [[], ini]),
    ([arr, last]) =&gt; arr
  )



<span class="hljs-built_in">module</span>.exports = {
  lastWord,
  partition,
  splitInWords,
  pipe,
  xor,
  map,
  reduce,
  flat,
  chainBlocks,
  chainBlocksInv,
  reverse
}</div></div></div></div></body></html>